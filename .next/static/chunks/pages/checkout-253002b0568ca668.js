(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2222],{95338:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return n(98771)}])},98771:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return se}});var t=n(47568),i=n(34051),s=n.n(i),o=n(85893),a=n(65582),c=n(86886),l=n(69849),d=n(67434),u=n(26042),h=n(69396),m=n(10797),p=n(61850),x=n(80251),f=n(69661),v=n(15861),y=n(87357),j=n(66242),g=n(64353),b=n(67720),Z=n(83321),C=n(50480),P=n(93946),S=n(61903),T=n(37867),O=n(9029),w=(n(44588),n(30403)),A=n(82580),k=n(67294),I=n(74231),E=n(50657),D=n(6514),_=n(30431),F=n(9669),N=n.n(F),W=n(8100),q=I.Ry({city:I.Z_().required("Required"),country:I.Z_().required("Required"),address:I.Z_().required("Required")}),R=function(e){var r=e.addressData,n=e.selected,i=e.setAddressData,a=e.openEditForm,l=e.setOpenEditForm,d=function(){var e=(0,t.Z)(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(r).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),h=(0,W.ZP)("https://chitralhive.com/api/getwebcountries",d),m=h.data,p=(h.error,(0,k.useState)([])),x=p[0],f=p[1],j=function(){var e=(0,t.Z)(s().mark((function e(r){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.target.value,e.prev=1,e.next=4,N().get("https://chitralhive.com/api/"+"getwebcities?country=".concat(n));case 4:t=e.sent,f(t.data.citylist),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Error fetching cities:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}();(0,k.useEffect)((function(){b.setValues({city:(null===n||void 0===n?void 0:n.city)||"",country:(null===n||void 0===n?void 0:n.country)||"",address:(null===n||void 0===n?void 0:n.address)||""})}),[n]);var g={city:(null===n||void 0===n?void 0:n.city)||"",country:(null===n||void 0===n?void 0:n.country)||"",address:(null===n||void 0===n?void 0:n.address)||""},b=(0,A.TA)({initialValues:g,validationSchema:q,onSubmit:function(e){var t=r.map((function(r){return r.address===n.address?(0,u.Z)({},r,e):r}));i(t),l(!1)}});return(0,o.jsx)(E.Z,{open:a,onClose:function(){return l(!1)},children:(0,o.jsxs)(D.Z,{children:[(0,o.jsx)(v.Z,{variant:"h6",mb:3,children:"Edit Address Information"}),(0,o.jsxs)("form",{onSubmit:b.handleSubmit,children:[(0,o.jsx)(y.Z,{mb:3,children:(0,o.jsxs)(c.ZP,{container:!0,spacing:3,children:[(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{select:!0,fullWidth:!0,color:"info",size:"medium",name:"country",value:b.values.country,onChange:function(e){b.handleChange(e),j(e)},label:"Country",error:!!b.touched.country&&!!b.errors.country,helperText:b.touched.country&&b.errors.country,children:m&&m.countrylist?m.countrylist.map((function(e){return(0,o.jsx)(_.Z,{value:e.name,children:e.name},e.id)})):""})}),(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{select:!0,fullWidth:!0,color:"info",size:"medium",name:"city",value:b.values.city,onChange:b.handleChange,label:"City",error:b.touched.city&&Boolean(b.errors.city),helperText:b.touched.city&&b.errors.city,children:x&&x?x.map((function(e){return(0,o.jsx)(_.Z,{value:e.name,children:e.name},e.id)})):""})}),(0,o.jsx)(c.ZP,{item:!0,sm:12,xs:12,children:(0,o.jsx)(S.Z,{fullWidth:!0,multiline:!0,rows:3,type:"text",name:"address",label:"Complete Address",value:b.values.address,inputProps:{maxLength:150},onChange:b.handleChange,error:b.touched.address&&Boolean(b.errors.address),helperText:b.touched.address&&b.errors.address})})]})}),(0,o.jsx)(Z.Z,{color:"primary",variant:"contained",type:"submit",children:"Save"})]})]})})},z=I.Ry({address:I.Z_().required("required"),city:I.Z_().required("required"),country:I.Z_().required("required")}),H={city:"",address:"",country:""},G=function(e){var r=e.setNewAddress,n=e.setFieldValue,i=function(){var e=(0,t.Z)(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(r).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),a=(0,W.ZP)("https://chitralhive.com/api/getwebcountries",i),l=a.data,d=(a.error,(0,k.useState)([])),u=d[0],h=d[1],m=function(){var e=(0,t.Z)(s().mark((function e(r){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.target.value,e.prev=1,e.next=4,N().get("https://chitralhive.com/api/"+"getwebcities?country=".concat(n));case 4:t=e.sent,h(t.data.citylist),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Error fetching cities:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}(),p=(0,k.useState)(!1),x=p[0],f=p[1],y=(0,A.TA)({initialValues:H,validationSchema:z,onSubmit:function(e,t){var i=t.resetForm;r(e),e&&(n("address",e.address),n("city",e.city),f(!1),i(H))}}),j=y.handleChange,g=y.handleSubmit,b=y.errors,C=y.touched,P=y.values;return(0,o.jsxs)(k.Fragment,{children:[(0,o.jsx)(Z.Z,{color:"primary",variant:"outlined",sx:{p:"2px 20px"},onClick:function(){return f(!x)},children:"Add New Address"}),(0,o.jsx)(E.Z,{open:x,onClose:function(){return f(!1)},children:(0,o.jsxs)(D.Z,{children:[(0,o.jsx)(v.Z,{variant:"h6",mb:3,children:"Add New Address Information"}),(0,o.jsx)("form",{onSubmit:g,children:(0,o.jsxs)(c.ZP,{container:!0,spacing:3,children:[(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{select:!0,fullWidth:!0,color:"info",size:"medium",name:"country",value:P.country,onChange:function(e){j(e),m(e)},label:"Country",error:!!C.country&&!!b.country,helperText:C.country&&b.country,children:l&&l.countrylist?l.countrylist.map((function(e){return(0,o.jsx)(_.Z,{value:e.name,children:e.name},e.id)})):""})}),(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{select:!0,fullWidth:!0,color:"info",size:"medium",name:"city",value:P.city,onChange:j,label:"City",error:!!C.city&&!!b.city,helperText:C.city&&b.city,children:u&&u?u.map((function(e){return(0,o.jsx)(_.Z,{value:e.name,children:e.name},e.id)})):""})}),(0,o.jsx)(c.ZP,{item:!0,sm:12,xs:12,children:(0,o.jsx)(S.Z,{fullWidth:!0,multiline:!0,rows:3,inputProps:{maxLength:150},type:"text",name:"address",label:"Complete Address",value:P.address,onChange:j,helperText:C.address&&b.address,error:C.address&&Boolean(b.address)})}),(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(Z.Z,{color:"primary",variant:"contained",type:"submit",children:"Save"})})]})})]})})]})},V=n(55503),B=n(13029),L=n(21737),$=n(33299),J=n(55678),K=k.forwardRef((function(e,r){return(0,o.jsx)(L.Z,(0,u.Z)({elevation:6,ref:r,variant:"filled"},e))})),M=function(e){var r=e.number,n=e.title;return(0,o.jsxs)(O.hs,{gap:1.5,alignItems:"center",mb:3.5,children:[(0,o.jsx)(f.Z,{sx:{width:32,height:32,color:"primary.text",backgroundColor:"primary.main"},children:r}),(0,o.jsx)(v.Z,{fontSize:"20px",children:n})]})},U=function(e){return e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e)?null:"Invalid email format":"Email is required"},X=I.Ry().shape({name:I.Z_().required("required"),email:I.Z_().required("required"),phone:I.Rx().required("required"),phone2:I.Rx().required("required"),address:I.Z_().required("required"),voucher:I.Z_()}),Y=function(e){var r,n,t,i=e.handleFormSubmit,s=e.paymentMethod,a=e.setPaymentMethod,l=(e.couponData,e.setCouponData),d=e.isCouponValid,f=e.setIsCouponValid,I=e.setAddress,E=(0,k.useState)(!1),D=E[0],_=E[1],F=(0,k.useState)(""),N=F[0],q=F[1],z=(0,k.useState)([]),H=(z[0],z[1],(0,k.useState)([])),L=H[0],Y=H[1],Q=(0,k.useState)(!1),ee=Q[0],re=Q[1],ne=(0,k.useState)(!1),te=ne[0],ie=ne[1],se=(0,k.useState)(!1),oe=se[0],ae=(se[1],(0,V.bp)().state),ce=ae.cart,le=function(){return ce.reduce((function(e,r){return e+r.price*r.qty}),0)},de=function(e,r,n,t){return function(){oe||(n(r,e),n("city",t),I(t))}},ue=function(){return _((function(e){return!e}))};(0,k.useEffect)((function(){console.log("mhy",L),I(L&&L&&L[0]?L[0].city:"")}),[L]),(0,k.useEffect)((function(){var e=L.some((function(e){return e.address===N.address}));""!==N&&Y(e?[]:[N].concat((0,m.Z)(L)))}),[N]);var he=function(e){L.splice(e,1),Y(L)},me=function(e,r){var n=L[r];ie(n),re(!ee)},pe=function(e){var r=e.target.name;a(r)},xe=(0,k.useState)(!1),fe=xe[0],ve=xe[1],ye=(0,k.useState)(""),je=ye[0],ge=ye[1],be=(0,k.useState)(""),Ze=be[0],Ce=be[1],Pe=function(e,r){"clickaway"!==r&&ve(!1)},Se=(0,$.useSession)(),Te=Se.data,Oe=(Se.status,{name:(null===Te||void 0===Te||null===(r=Te.user)||void 0===r?void 0:r.name)||"",email:(null===Te||void 0===Te||null===(n=Te.user)||void 0===n?void 0:n.email)||"",phone:(null===Te||void 0===Te||null===(t=Te.user)||void 0===t?void 0:t.phone)||"",phone2:"",voucher:""}),we=(0,k.useState)(!1),Ae=(we[0],we[1]),ke=(0,k.useState)([]),Ie=ke[0],Ee=ke[1],De=(0,k.useState)([]),_e=De[0],Fe=De[1],Ne="https://chitralhive.com/api/getCustomerShipping",We=(0,W.ZP)(Ne,(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return fetch(Ne,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Te.accessToken},body:JSON.stringify({id:Te.user.id})}).then((function(e){return e.json()})).then((function(e){Ee(e)})).catch((function(e){}))})),qe=(We.orders,We.error,(0,k.useState)(Oe)),Re=qe[0],ze=qe[1],He="https://chitralhive.com/api/getallcities",Ge=(0,W.ZP)(He,(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return fetch(He,{method:"POST"}).then((function(e){return e.json()})).then((function(e){Fe(e)})).catch((function(e){}))})),Ve=(Ge.orders,Ge.error,function(e){fetch("https://chitralhive.com/api/checkvoucher",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Te.accessToken},body:JSON.stringify({couponCode:e,userid:Te.user.id})}).then((function(e){return e.json()})).then((function(e){e.isValid?(ze((0,h.Z)((0,u.Z)({},Re),{voucher:""})),J.Am.success("Coupon Sucessfully Applied",{position:J.Am.POSITION.TOP_RIGHT}),f(!0),l(e.couponData)):"409"===e.status?(J.Am.error(e.message,{position:J.Am.POSITION.TOP_RIGHT}),f(!1),l(null)):(J.Am.error("Invalid Coupon",{position:J.Am.POSITION.TOP_RIGHT}),f(!1),l(null))})).catch((function(e){console.error("Error checking coupon validity:",e)}))});return Te?(0,o.jsx)(A.J9,{onSubmit:i,initialValues:Oe,validationSchema:X,children:function(r){var n=r.values,t=r.errors,i=r.touched,a=r.handleChange,l=r.handleSubmit,u=r.setFieldValue;return(0,o.jsxs)("form",{onSubmit:l,children:[(0,o.jsxs)(T.Z,{sx:{mb:3},children:[(0,o.jsx)(M,{number:1,title:"Personal Information"}),(0,o.jsx)(y.Z,{mb:3.5,children:(0,o.jsxs)(c.ZP,{container:!0,spacing:3,children:[(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{fullWidth:!0,inputProps:{maxLength:150},type:"text",name:"name",onChange:a,label:"Full Name",value:n.name||Te.user.name,error:!!i.name&&!!t.name,helperText:i.name&&t.name})}),(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsxs)(y.Z,{display:"flex",flexDirection:"column",children:[(0,o.jsx)(A.gN,{fullWidth:!0,placeholder:"\xa0\xa0Email",validate:U,type:"email",name:"email",onChange:a,label:" Email Address",value:n.email,error:i.email&&t.email,style:i.email&&t.email?{height:"36px",width:"100%",border:"2.3px solid #cd3232",borderRadius:"4px",outline:"none",transition:"border-color 0.3s ease",fontSize:"15px",color:"grey"}:{height:"36px",width:"100%",border:"1.3px solid #b9b5b5",borderRadius:"4px",outline:"none",transition:"border-color 0.3s ease",fontSize:"15px",color:"#2B3445"},InputProps:{style:{fontSize:"15px",fontStyle:"inherit",color:"red",paddingLeft:"10px"}}}),t.email&&i.email&&(0,o.jsx)("div",{style:{color:"red"},children:t.email})]})}),(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{fullWidth:!0,type:"text",name:"phone",onChange:a,label:"Primary Phone",onKeyPress:function(e){var r=e.keyCode||e.which,n=String.fromCharCode(r);/[0-9+\-]/.test(n)||8===r||9===r||e.preventDefault()},value:n.phone,inputProps:{maxLength:150},error:!!i.phone&&!!t.phone,helperText:i.phone&&t.phone})}),(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{fullWidth:!0,type:"text",name:"phone2",onKeyPress:function(e){var r=e.keyCode||e.which,n=String.fromCharCode(r);/[0-9+\-]/.test(n)||8===r||9===r||e.preventDefault()},onChange:a,label:"Secondary Phone",inputProps:{maxLength:150},value:n.phone2,error:!!i.phone2&&!!t.phone2,helperText:i.phone2&&t.phone2})})]})})]}),(0,o.jsxs)(T.Z,{sx:{mb:3},children:[(0,o.jsx)(B.Z,{open:fe,autoHideDuration:6e3,onClose:Pe,children:(0,o.jsx)(K,{onClose:Pe,severity:Ze,sx:{width:"100%"},children:je})}),(0,o.jsxs)(O.$9,{children:[(0,o.jsx)(M,{number:2,title:"Delivery Address"}),(0,o.jsx)(G,{setNewAddress:q,setFieldValue:u,citydata:_e&&_e.length>0?_e:""})]}),(0,o.jsx)(v.Z,{mb:1.5,children:"Delivery Address"}),(0,o.jsx)(c.ZP,{container:!0,spacing:3,children:Ie.length>0?Ie.map((function(e,r){return(0,o.jsx)(c.ZP,{item:!0,md:4,sm:6,xs:12,children:(0,o.jsxs)(j.Z,{sx:{padding:2,boxShadow:"none",cursor:"pointer",border:"1px solid",position:"relative",backgroundColor:"grey.100",borderColor:e.address===n.address?"primary.main":"transparent"},onClick:de(e.address,"address",u,e.area),children:[(0,o.jsx)(O.hs,{justifyContent:"flex-end",sx:{position:"absolute",top:5,right:5},children:te&&(0,o.jsx)(R,{selected:te,data:Ae,addressData:L,openEditForm:ee,setOpenEditForm:re,setAddressData:Y,ind:r,citydata:_e&&_e.length>0?_e:""})}),(0,o.jsx)(w.H6,{mb:.5,children:e.area}),(0,o.jsx)(w.nv,{color:"grey.700",children:e.country}),e.address&&(0,o.jsx)(w.nv,{color:"grey.700",children:e.address})]})},r)})):""}),(0,o.jsx)("br",{}),(0,o.jsx)(c.ZP,{container:!0,spacing:3,children:L.map((function(e,r){return(0,o.jsx)(c.ZP,{item:!0,md:4,sm:6,xs:12,children:(0,o.jsxs)(j.Z,{sx:{padding:2,boxShadow:"none",cursor:"pointer",border:"1px solid",position:"relative",backgroundColor:"grey.100",borderColor:e.address===n.address?"primary.main":"transparent"},onClick:de(e.address,"address",u,e.city),children:[(0,o.jsxs)(O.hs,{justifyContent:"flex-end",sx:{position:"absolute",top:5,right:5},children:[te&&(0,o.jsx)(R,{selected:te,data:Ae,addressData:L,openEditForm:ee,setOpenEditForm:re,setAddressData:Y,ind:r,citydata:_e&&_e.length>0?_e:""}),(0,o.jsx)(P.Z,{size:"small",sx:{mr:1},onClick:function(){return me(e.address,r)},children:(0,o.jsx)(p.Z,{sx:{fontSize:20}})}),(0,o.jsx)(P.Z,{size:"small",color:"error",onClick:function(){return he(r)},children:(0,o.jsx)(x.Z,{sx:{fontSize:20}})})]}),(0,o.jsx)(w.H6,{mb:.5,children:e.city}),(0,o.jsx)(w.nv,{color:"grey.700",children:e.country}),e.address&&(0,o.jsx)(w.nv,{color:"grey.700",children:e.address})]})},r)}))})]}),(0,o.jsxs)(T.Z,{sx:{mb:3},children:[(0,o.jsx)(M,{number:3,title:"Payment Type"}),(0,o.jsx)(C.Z,{name:"cod",onChange:pe,label:(0,o.jsx)(w.nv,{fontWeight:600,children:"Cash On Delivery"}),control:(0,o.jsx)(g.Z,{checked:"cod"===s,color:"primary",size:"small"})}),(0,o.jsx)(b.Z,{sx:{mb:3,mx:-4}}),(0,o.jsx)(C.Z,{name:"credit-card",onChange:pe,label:(0,o.jsx)(w.nv,{fontWeight:600,children:"Pay with Credit/Debit Card"}),control:(0,o.jsx)(g.Z,{checked:"credit-card"===s,color:"primary",size:"small"})}),(0,o.jsx)(b.Z,{sx:{mb:3,mx:-4}}),(0,o.jsx)(Z.Z,{sx:{color:"primary.main",mt:3,lineHeight:1},onClick:ue,children:"I have a voucher"}),D&&(0,o.jsxs)(O.hs,{mt:3,gap:2,maxWidth:"400px",children:[(0,o.jsx)(S.Z,{fullWidth:!0,name:"voucher",value:n.voucher,onChange:a,placeholder:"Enter voucher code here"}),(0,o.jsx)(Z.Z,{variant:"contained",color:"primary",type:"button",onClick:function(){Ve(n.voucher),a({target:{name:"voucher",value:""}})},disabled:d,children:"Apply"})]}),"0.00"===le().toFixed(2)||0==ce.length||0===ae.cart.length?(0,o.jsx)(Z.Z,{fullWidth:!0,type:"submit",disabled:!0,color:"primary",variant:"contained",sx:{mt:3},children:"Place Order"}):(0,o.jsx)(Z.Z,{fullWidth:!0,type:"submit",onClick:function(){return t.name||t.email||t.phone||t.phone2?(Ce("error"),ge("Fill all the blank fields."),ve(!0),!1):!!n.address||(Ce("warning"),ge("Invalid Address! Select Address or Create a one to Place Order."),ve(!0),!1)},color:"primary",disabled:e.isDisabled,variant:"contained",sx:{mt:3},children:"Place Order"})]})]})}}):(0,o.jsx)(A.J9,{onSubmit:i,initialValues:Oe,validationSchema:X,children:function(r){var n=r.values,t=r.errors,i=r.touched,a=r.handleChange,l=r.handleSubmit,d=r.setFieldValue;return(0,o.jsxs)("form",{onSubmit:l,children:[(0,o.jsxs)(T.Z,{sx:{mb:3},children:[(0,o.jsx)(M,{number:1,title:"Personal Information"}),(0,o.jsx)(y.Z,{mb:3.5,children:(0,o.jsxs)(c.ZP,{container:!0,spacing:3,children:[(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{fullWidth:!0,type:"text",name:"name",inputProps:{maxLength:150},onChange:a,label:"Full Name",value:n.name,error:!!i.name&&!!t.name,helperText:i.name&&t.name})}),(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsxs)(y.Z,{display:"flex",flexDirection:"column",children:[(0,o.jsx)(A.gN,{fullWidth:!0,placeholder:"\xa0\xa0Email",validate:U,type:"email",name:"email",onChange:a,label:" Email Address",value:n.email,error:i.email&&t.email,style:i.email&&t.email?{height:"36px",width:"100%",border:"2.3px solid #cd3232",borderRadius:"4px",outline:"none",transition:"border-color 0.3s ease",fontSize:"15px",color:"grey"}:{height:"36px",width:"100%",border:"1.3px solid #b9b5b5",borderRadius:"4px",outline:"none",transition:"border-color 0.3s ease",fontSize:"15px",color:"#2B3445"},InputProps:{style:{fontSize:"15px",fontStyle:"inherit",color:"red"}}}),t.email&&i.email&&(0,o.jsx)("div",{style:{color:"red"},children:t.email})]})}),(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{fullWidth:!0,type:"text",name:"phone",onChange:a,onKeyPress:function(e){var r=e.keyCode||e.which,n=String.fromCharCode(r);/[0-9+\-]/.test(n)||8===r||9===r||e.preventDefault()},label:"Primary Phone",value:n.phone||"",error:!!i.phone&&!!t.phone,helperText:i.phone&&t.phone})}),(0,o.jsx)(c.ZP,{item:!0,sm:6,xs:12,children:(0,o.jsx)(S.Z,{fullWidth:!0,type:"text",name:"phone2",onChange:a,label:"Secondary Phone",inputProps:{maxLength:150},onKeyPress:function(e){var r=e.keyCode||e.which,n=String.fromCharCode(r);/[0-9+\-]/.test(n)||8===r||9===r||e.preventDefault()},value:n.phone2,error:!!i.phone2&&!!t.phone2,helperText:i.phone2&&t.phone2})})]})})]}),(0,o.jsxs)(T.Z,{sx:{mb:3},children:[(0,o.jsx)(B.Z,{open:fe,autoHideDuration:6e3,onClose:Pe,children:(0,o.jsx)(K,{onClose:Pe,severity:Ze,sx:{width:"100%"},children:je})}),(0,o.jsxs)(O.$9,{children:[(0,o.jsx)(M,{number:2,title:"Delivery Address"}),(0,o.jsx)(G,{setNewAddress:q,setFieldValue:d,citydata:_e&&_e.length>0?_e:""})]}),(0,o.jsx)(v.Z,{mb:1.5,children:"Delivery Address"}),(0,o.jsx)(c.ZP,{container:!0,spacing:3,children:L.map((function(e,r){return(0,o.jsx)(c.ZP,{item:!0,md:4,sm:6,xs:12,children:(0,o.jsxs)(j.Z,{sx:{padding:2,boxShadow:"none",cursor:"pointer",border:"1px solid",position:"relative",backgroundColor:"grey.100",borderColor:e.address===n.address?"primary.main":"transparent"},onClick:de(e.address,"address",d,e.city),children:[(0,o.jsxs)(O.hs,{justifyContent:"flex-end",sx:{position:"absolute",top:5,right:5},children:[te&&(0,o.jsx)(R,{selected:te,data:Ae,addressData:L,openEditForm:ee,setOpenEditForm:re,setAddressData:Y,ind:r,citydata:_e&&_e.length>0?_e:""}),(0,o.jsx)(P.Z,{size:"small",sx:{mr:1},onClick:function(){return me(e.address,r)},children:(0,o.jsx)(p.Z,{sx:{fontSize:20}})}),(0,o.jsx)(P.Z,{size:"small",color:"error",onClick:function(){return he(r)},children:(0,o.jsx)(x.Z,{sx:{fontSize:20}})})]}),(0,o.jsx)(w.H6,{mb:.5,children:e.city}),(0,o.jsx)(w.nv,{color:"grey.700",children:e.country}),e.address&&(0,o.jsx)(w.nv,{color:"grey.700",children:e.address})]})},r)}))})]}),(0,o.jsxs)(T.Z,{sx:{mb:3},children:[(0,o.jsx)(M,{number:3,title:"Payment Type"}),(0,o.jsx)(C.Z,{name:"cod",onChange:pe,label:(0,o.jsx)(w.nv,{fontWeight:600,children:"Cash On Delivery"}),control:(0,o.jsx)(g.Z,{checked:"cod"===s,color:"primary",size:"small"})}),(0,o.jsx)(b.Z,{sx:{mb:3,mx:-4}}),(0,o.jsx)(C.Z,{name:"credit-card",onChange:pe,label:(0,o.jsx)(w.nv,{fontWeight:600,children:"Pay with Credit/Debit Card"}),control:(0,o.jsx)(g.Z,{checked:"credit-card"===s,color:"primary",size:"small"})}),(0,o.jsx)(b.Z,{sx:{mb:3,mx:-4}}),(0,o.jsx)(Z.Z,{sx:{color:"primary.main",mt:3,lineHeight:1},onClick:ue,children:"I have a voucher"}),D&&(0,o.jsx)(O.hs,{mt:3,gap:2,maxWidth:"400px",children:(0,o.jsx)("span",{children:"Please Login to use coupon"})}),"0.00"===le().toFixed(2)||0==ce.length||0===ae.cart.length?(0,o.jsx)(Z.Z,{fullWidth:!0,type:"submit",disabled:!0,color:"dark",variant:"contained",sx:{mt:3},children:"Place Order"}):(0,o.jsx)(Z.Z,{fullWidth:!0,type:"submit",onClick:function(){return t.name||t.email||t.phone||t.phone2?(Ce("error"),ge("Fill all the blank fields."),ve(!0),!1):!!n.address||(Ce("warning"),ge("Invalid Address! Select Address or Create a one to Place Order."),ve(!0),!1)},color:"primary",variant:"contained",disabled:e.isDisabled,sx:{mt:3},children:"Place Order"})]})]})}})},Q=function(e){var r=e.DeliveryFee,n=e.couponData,t=e.setTotalPrice,i=(0,V.bp)().state.cart,s=function(){return i.reduce((function(e,r){return e+r.salePrice*r.qty}),0)},a=(0,k.useState)(""),c=a[0],l=a[1];(0,k.useEffect)((function(){if(window.localStorage){var e=localStorage.getItem("currency");l(e)}}),[]);var d=(0,k.useState)(0),u=d[0],h=d[1],m=(0,k.useState)(0),p=m[0],x=m[1];return(0,k.useEffect)((function(){if(null!==n&&n){var e=parseFloat(n.discount),r=s().toFixed(2)*e/100,t=s().toFixed(2)-r;h(r),x(t)}else{var i=0*s().toFixed(2)/100,o=s().toFixed(2)-i;h(i),x(o)}}),[n]),t(p+r),(0,k.useEffect)((function(){t(p+r)}),[s,p,r]),(0,o.jsxs)(y.Z,{children:[(0,o.jsx)(w.nv,{color:"secondary.900",fontWeight:700,mb:2,children:"Your order"}),i.map((function(e){return(0,o.jsxs)(O.$9,{mb:1.5,children:[(0,o.jsxs)(w.nv,{children:[(0,o.jsx)(w.Dr,{fontWeight:"700",fontSize:"14px",children:e.qty})," ","x ",e.name]}),(0,o.jsxs)(w.nv,{children:[c,". ",e.salePrice.toFixed(2)]})]},e.name)})),(0,o.jsx)(b.Z,{sx:{borderColor:"grey.300",my:3}}),(0,o.jsxs)(O.$9,{mb:.5,children:[(0,o.jsx)(w.nv,{color:"grey.600",children:"Subtotal:"}),(0,o.jsxs)(w.nv,{fontWeight:"700",children:[c,". ",s().toFixed(2)]})]}),(0,o.jsxs)(O.$9,{mb:.5,children:[(0,o.jsx)(w.nv,{color:"grey.600",children:"Delivery Fee:"}),(0,o.jsxs)(w.nv,{fontWeight:"700",children:[c,". ",r]})]}),(0,o.jsxs)(O.$9,{mb:.5,children:[(0,o.jsx)(w.nv,{color:"grey.600",children:"Tax:"}),(0,o.jsx)(w.nv,{fontWeight:"700",children:"-"})]}),(0,o.jsxs)(O.$9,{mb:3,children:[(0,o.jsx)(w.nv,{color:"grey.600",children:"Discount:"}),(0,o.jsxs)(w.nv,{fontWeight:"700",children:[c,". ",u.toFixed(2)]})]}),(0,o.jsx)(b.Z,{sx:{borderColor:"grey.300",mb:1}}),(0,o.jsxs)(O.$9,{fontWeight:"700",mb:1,children:[(0,o.jsx)(w.nv,{children:"Total:"}),(0,o.jsxs)(w.nv,{fontWeight:"700",children:[c,". ",s()+parseFloat(r)-parseFloat(u)]})]})]})},ee=n(82750),re=n(11163),ne=n(2734),te=n(25018),ie=n.n(te),se=function(){var e=function(e,r,t){var i={userid:e,voucherid:r,vouchercode:t};N().post("https://chitralhive.com/api/savevoucherdata",i,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+n.accessToken}}).then((function(e){console.log("Data saved successfully:",e.data)})).catch((function(e){console.error("Error saving data:",e)}))},r=(0,$.useSession)(),n=r.data,i=(r.status,(0,k.useState)([])),u=(i[0],i[1],(0,k.useState)(!1)),h=u[0],m=u[1],p=(0,k.useState)(0),x=p[0],f=p[1],v=(0,k.useState)("cod"),y=v[0],j=v[1],g=(0,ne.Z)(),b=(0,re.useRouter)(),Z=(0,V.bp)().state,C=function(){var e=(0,t.Z)(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N().get(r).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),P=(0,W.ZP)("https://chitralhive.com/api/getGeneralSetting",C),S=(P.data,P.error,Z.cart);function T(){return T=(0,t.Z)(s().mark((function r(t,i,o,a,c){var l,d;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(l=o-a,!n){r.next=8;break}return d=n.user.id,r.next=5,ee.Z.addOrder(t,i,o,a,d).then((function(r){200==r.status&&("cod"!=y?(z&&e(d,B.id,B.code),O(i,r.data.addOrder.orderNo,l,a,t.email)):(z&&e(d,B.id,B.code),J.Am.success("Order Added Successfully",{position:J.Am.POSITION.TOP_RIGHT}),Z.cart.length=null,c.push("/order-confirmation")))})).catch((function(e){if(e.response){if(400==e.response.status){var r=Object.keys(e.response.data)[0];J.Am.error(e.response.data[r].toString(),{position:J.Am.POSITION.TOP_RIGHT})}else J.Am.error("Error Occured while Updating Product "+e.response.statusText,{position:J.Am.POSITION.TOP_RIGHT});return e.response}return e.request?(J.Am.error("Network Error",{position:J.Am.POSITION.TOP_RIGHT}),e.request):(J.Am.error("Error Occured",{position:J.Am.POSITION.TOP_RIGHT}),e)}));case 5:r.sent,r.next=12;break;case 8:return null,r.next=11,ee.Z.addOrder(t,i,o,null,a).then((function(e){200==e.status&&("cod"!=y?(console.log("payment with credit card"),O(i,e.data.addOrder.orderNo,l,a,t.email)):(J.Am.success("Order Added Successfully",{position:J.Am.POSITION.TOP_RIGHT}),Z.cart.length=null,c.push("/order-confirmation")))})).catch((function(e){if(e.response){if(400==e.response.status){var r=Object.keys(e.response.data)[0];J.Am.error(e.response.data[r].toString(),{position:J.Am.POSITION.TOP_RIGHT})}else J.Am.error("Error Occured while Adding Order "+e.response.statusText,{position:J.Am.POSITION.TOP_RIGHT});return e.response}return e.request?(J.Am.error("Network Error",{position:J.Am.POSITION.TOP_RIGHT}),e.request):(J.Am.error("Error Occured",{position:J.Am.POSITION.TOP_RIGHT}),e)}));case 11:r.sent;case 12:case"end":return r.stop()}}),r)}))),T.apply(this,arguments)}var O=function(){var e=(0,t.Z)(s().mark((function e(r,n,t,i,o){var a,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie()();case 2:return e.sent,e.prev=3,e.next=6,fetch("/api/create-checkout-session/",{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-cache",body:JSON.stringify({cartList:r,orderno:n,totalPrice:t,deliveryFee:i,email:o})});case 6:if(!(a=e.sent).ok){e.next=14;break}return e.next=10,a.json();case 10:c=e.sent,window.location.href=c.url,e.next=15;break;case 14:console.log("Request failed");case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),console.log("Error occurred during the request",e.t0);case 20:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(r,n,t,i,s){return e.apply(this,arguments)}}(),w=(0,k.useState)(""),A=w[0],I=w[1];(0,k.useEffect)((function(){}),[A]);var E=(0,k.useState)(),D=E[0],_=E[1];(0,k.useEffect)((function(){if(A&&A){fetch("https://chitralhive.com/api/calculateweight",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cartList:S,city:A})}).then((function(e){return e.json()})).then((function(e){_(e)})).catch((function(e){console.error("Error fetching shipping price:",e)}))}}),[A]);var F=(0,k.useState)(),q=(F[0],F[1]),R=(0,k.useState)(!1),z=R[0],H=R[1],G=(0,k.useState)(null),B=G[0],L=G[1];return(0,o.jsxs)(l.Z,{topbarBgColor:g.palette.grey[900],navCategories:[],children:[(0,o.jsx)(d.Z,{title:"Checkout",metaTitle:"Checkout - Online Book Store"}),(0,o.jsx)(a.Z,{sx:{my:"1.5rem"},children:(0,o.jsxs)(c.ZP,{container:!0,spacing:3,children:[(0,o.jsx)(c.ZP,{item:!0,lg:8,md:8,xs:12,children:(0,o.jsx)(Y,{isDisabled:h,handleFormSubmit:function(e){var r=Z.cart,n=D&&D?D.shippingCharges:300;!function(e,r,n,t,i){T.apply(this,arguments)}(e,r,x,n,b),m(!0)},couponData:B,setCouponData:L,isCouponValid:z,setIsCouponValid:H,paymentMethod:y,setPaymentMethod:j,setFieldValue:q,setAddress:I})}),(0,o.jsx)(c.ZP,{item:!0,lg:4,md:4,xs:12,children:(0,o.jsx)(Q,{DeliveryFee:D&&D?D.shippingCharges:0,couponData:B,setTotalPrice:f})})]})})]})}},37867:function(e,r,n){"use strict";var t=n(14924),i=n(90948),s=n(66242),o=(0,i.ZP)(s.Z)((0,t.Z)({position:"relative",padding:"1.5rem 1.75rem"},"@media only screen and (max-width: 678px)",{padding:"1rem"}));r.Z=o},67434:function(e,r,n){"use strict";var t=n(85893),i=n(9008),s=n.n(i);n(67294);r.Z=function(e){var r=e.title,n=e.description,i=e.metaTitle;e.sitename;return"ChitralHive",(0,t.jsxs)(s(),{children:[(0,t.jsxs)("title",{children:[r," | ","ChitralHive"]}),(0,t.jsx)("meta",{name:"title",content:i?i+" - "+r:"Buy Products Online - Ecommerce"}),(0,t.jsx)("meta",{name:"description",content:n||"Get in touch with Chitral Hive for authentic Chitrali products. We're here to help with your orders and inquiries. Contact us via phone, email, or visit our store in Chitral.Get in touch with Chitral Hive for authentic Chitrali products. We're here to help with your orders and inquiries. Contact us via phone, email, or visit our store in Chitral."})]})}},25018:function(e,r,n){"use strict";var t,i=n(83454),s=n(54465).J;e.exports=function(){var e=i.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY||"";return!t&&e&&(t=s(e)),t}}},function(e){e.O(0,[2962,939,2478,5394,9579,9154,4207,4210,7764,9849,9774,2888,179],(function(){return r=95338,e(e.s=r);var r}));var r=e.O();_N_E=r}]);